ТЗ на супер-терминалку
версия 1.0 от 07.12.2012


Суть: Супер-терминалка (далее – просто терминалка) есть приложение для двунаправленного обмена данными через последовательный COM-порт между ПК и каким-либо периферийным устройством. Требуется для счастья системным программистам при работе с программируемыми системами.



Общее описание:

Терминалка представляет собой приложение для ОС семейства Windows (начиная с версии XP, и более новых версий).



Потоки данных

Терминалка имеет 2 потока данных – входные данные от удаленного прибора, выходные данные от пользователя. 
Входной поток данных должен отображаться сразу же по получении хотя бы одного символа.
Выходной поток может работать в двух режимах:
- Данные подготавливаются для отправки пользователем и отправляются единым пакетом по его команде.
- Данные отправляются посимвольно (поблочно в случае вставки из буфера обмена) по мере ввода пользователем. При этом данные в поле ввода отображаются только до тех пор, пока не были отправлены (либо как-нибудь иначе пользователь должен понимать, что уже отправлено, а что еще висит в очереди на отправку).
- Данные для отправки берутся из файла. В этом случае данные пересылаются полностью.
*Опционально - подумать на тему добавления маркеров паузы отправки. Т.е. если в файле написано "send ok[pause:5000]cmd=8", то отправлять "send ok", через 5 секунд отправлять "cmd=8".
Для всех потоков необходимо вести подсчет прошедших байт.

Для исходящего потока данные можно вводить как в текстовом, так и в двоичном виде. Для этого должен быть предусмотрен переключатель, управляющий типом ввода. При вводе строки в двоичном виде допускается наличие пробелов в произвольных местах.
Входящий поток так же может быть отображен как в символьном, так и в двоичном виде.
Предусмотреть возможность одновременного отображения символьного и двоичного вида. При этом пользователь должен четко видеть соответствие отображаемых данных.

Терминалка работает как с реальными COM-портами, так и с виртуальными на базе USB-устройств.  Терминалка должна быть устойчивой к пропаданию порта из списка доступных, закрывая текущее соединение, всегда иметь актуальный список доступных портов системы. При этом, если открытый в данной сессии порт исчезает из списка доступных, то у пользователя должна быть возможность определять поведение терминалки - заново открывать соединение при появлении порта с тем же номером или нет.

Поддержка ввода с клавиатуры.
Для того, чтобы осчастливить пользователя, терминалка должна обладать поддержкой "горячих клавиш", ускоряющих работу с программой. Обработка горячих клавиш должна осуществляться независимо от текущего фокуса приложения.
- Открытие/закрытие порта;
- Отправка текущего подготовленного сообщения;
- Отправка сообщений, подготовленных в макросах;
- Очистка входящего потока данных.

Юзабельность.
Для непрекращающейся радости пользователя терминалка должна обладать ясным, четким, функциональным и не перегруженным интерфейсом. Для этого:
1) Настройки и статусную информацию можно разделить на важные и не важные. Важные должны быть видны и доступны для изменения из любого места программы. Это:
- номер используемого COM-порта;
- состояние соединения;
- количество байт в потоках.

2) Необходима ясная и простая возможность как следить за новыми данными входного потока с автоматической прокруткой, так и наблюдать за определенным сообщением в потоке 

3) При отображении входного и выходного потока в одном окне подсвечивать данные разными цветами.